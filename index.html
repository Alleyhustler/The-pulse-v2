<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Pulse v2 - Real Solana Token Monitor</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #0F1113;
            color: #F7F7F7;
            line-height: 1.4;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        :root {
            --bg-primary: #0F1113;
            --bg-secondary: #0B0B0C;
            --bg-surface: #1A1D21;
            --text-primary: #F7F7F7;
            --text-secondary: #8B8E92;
            --text-muted: #5D6065;
            --border-color: #2A2D32;
            --accent-teal: #00FFAA;
            --accent-purple: #9945FF;
            --positive: #00FFAA;
            --negative: #FF4473;
            --warning: #FFB443;
        }

        /* App Layout */
        .app {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
        }

        /* Header Styles */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            min-height: 64px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .app-title {
            font-size: 1.25rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, var(--accent-teal), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-dot.connected { background: var(--positive); }
        .status-dot.degraded { background: var(--warning); }
        .status-dot.polling { background: var(--negative); }
        .status-dot.disconnected { background: var(--text-muted); }

        .header-center {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
            max-width: 400px;
            margin: 0 2rem;
        }

        .search-input, .filter-select {
            padding: 0.5rem 1rem;
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.875rem;
            font-family: inherit;
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filter-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
            cursor: pointer;
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Pairs Feed */
        .pairs-feed {
            width: 400px;
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            background: var(--bg-secondary);
        }

        .feed-header {
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .count-badge {
            background: var(--bg-surface);
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            color: var(--text-primary);
        }

        .pairs-list {
            flex: 1;
            overflow-y: auto;
        }

        .pairs-list::-webkit-scrollbar {
            width: 4px;
        }

        .pairs-list::-webkit-scrollbar-track {
            background: transparent;
        }

        .pairs-list::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 2px;
        }

        /* Pair Card */
        .pair-card {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s ease;
            background: var(--bg-secondary);
        }

        .pair-card:hover {
            background: var(--bg-surface);
        }

        .pair-card.selected {
            background: var(--bg-surface);
            border-right: 2px solid;
            border-image: linear-gradient(135deg, var(--accent-teal), var(--accent-purple)) 1;
        }

        .pair-card.new {
            animation: pulse-glow 2s ease-in-out;
        }

        @keyframes pulse-glow {
            0% { background: var(--bg-secondary); }
            50% { background: rgba(0, 255, 170, 0.05); }
            100% { background: var(--bg-secondary); }
        }

        .pair-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .pair-name {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-weight: 600;
        }

        .token-symbol {
            color: var(--text-primary);
        }

        .pair-separator {
            color: var(--text-muted);
        }

        .quote-symbol {
            color: var(--text-secondary);
        }

        .verified-badge {
            background: var(--positive);
            color: var(--bg-primary);
            padding: 0.125rem 0.375rem;
            border-radius: 4px;
            font-size: 0.625rem;
            font-weight: 700;
        }

        .verified-badge.large {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }

        .pair-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .time-ago {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .watch-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 0.875rem;
            padding: 0.25rem;
            transition: color 0.2s ease;
            font-family: inherit;
        }

        .watch-btn:hover {
            color: var(--warning);
        }

        .watch-btn.watched {
            color: var(--warning);
        }

        .watch-btn.large {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.875rem;
        }

        .pair-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .stat {
            display: flex;
            flex-direction: column;
            gap: 0.125rem;
        }

        .stat label {
            font-size: 0.625rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat span {
            font-size: 0.875rem;
            font-weight: 600;
        }

        .positive {
            color: var(--positive);
        }

        .negative {
            color: var(--negative);
        }

        .trust-score {
            color: var(--accent-purple);
        }

        .pair-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .source-tag {
            font-size: 0.75rem;
            color: var(--text-muted);
            background: var(--bg-surface);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .price {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Pair Detail */
        .pair-detail {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: var(--bg-primary);
        }

        .pair-detail.empty {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .empty-state {
            text-align: center;
            color: var(--text-muted);
            max-width: 300px;
        }

        .empty-state h3 {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .detail-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .detail-title h2 {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .detail-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .detail-section {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .metric-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .metric-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .metric-value {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .performance-stats,
        .volume-stats {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .performance-item,
        .volume-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .performance-item:last-child,
        .volume-item:last-child {
            border-bottom: none;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .action-btn {
            padding: 0.75rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            font-family: inherit;
        }

        .action-btn:hover {
            background: var(--bg-primary);
            border-color: var(--accent-teal);
        }

        .action-btn.report:hover {
            border-color: var(--negative);
        }

        .address-box {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        .address-box code {
            flex: 1;
            font-family: 'Space Grotesk', monospace;
            font-size: 0.875rem;
            color: var(--text-secondary);
            word-break: break-all;
        }

        .copy-btn {
            padding: 0.5rem 1rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.75rem;
            font-family: inherit;
        }

        .copy-btn:hover {
            background: var(--bg-surface);
        }

        /* Footer */
        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1.5rem;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: var(--text-muted);
        }

        .error {
            color: var(--negative);
            padding: 1rem;
            text-align: center;
            background: var(--bg-surface);
            border-radius: 6px;
            margin: 1rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .pairs-feed {
                width: 350px;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }

        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) {
            .pair-card.new {
                animation: none;
            }
            
            .pair-card {
                transition: none;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // Real Solana Data Service
        const createRealDataService = () => {
            // Birdeye API for real token data
            const BIRDEYE_API = 'https://public-api.birdeye.so/public';
            const HELIUS_API = 'https://mainnet.helius-rpc.com/?api-key=';

            // Common Solana tokens for reference
            const COMMON_TOKENS = {
                'USDC': 'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v',
                'SOL': 'So11111111111111111111111111111111111111112',
                'BONK': 'DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263',
                'JUP': 'JUPyiwrYJFskUPiHa7hkeR8VUtAeFoSYbKedZNsDvCN',
                'RAY': '4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R'
            };

            let wsConnection = null;
            let reconnectTimeout = null;

            const connectWebSocket = (onMessage, onStatusChange) => {
                try {
                    // Using Birdeye WebSocket for real-time data (free tier)
                    wsConnection = new WebSocket('wss://public-api.birdeye.so/socket');
                    
                    wsConnection.onopen = () => {
                        onStatusChange('connected');
                        console.log('WebSocket connected to Birdeye');
                    };

                    wsConnection.onmessage = (event) => {
                        try {
                            const data = JSON.parse(event.data);
                            if (data.type === 'price_update') {
                                onMessage(parsePriceUpdate(data));
                            }
                        } catch (e) {
                            console.warn('Failed to parse WebSocket message:', e);
                        }
                    };

                    wsConnection.onclose = () => {
                        onStatusChange('disconnected');
                        // Attempt reconnect after 5 seconds
                        reconnectTimeout = setTimeout(() => {
                            connectWebSocket(onMessage, onStatusChange);
                        }, 5000);
                    };

                    wsConnection.onerror = (error) => {
                        console.error('WebSocket error:', error);
                        onStatusChange('degraded');
                    };

                } catch (error) {
                    console.error('WebSocket connection failed:', error);
                    onStatusChange('polling');
                    // Fallback to polling
                    startPolling(onMessage);
                }
            };

            const startPolling = (onMessage) => {
                const poll = async () => {
                    try {
                        const newPairs = await fetchRecentPairs();
                        newPairs.forEach(pair => onMessage(pair));
                    } catch (error) {
                        console.error('Polling error:', error);
                    }
                };

                // Poll every 10 seconds
                poll();
                return setInterval(poll, 10000);
            };

            const parsePriceUpdate = (data) => {
                return {
                    id: `pair_${data.address}`,
                    name: `${data.symbol || 'UNKNOWN'}/USDC`,
                    tokenAddress: data.address,
                    baseToken: data.symbol || 'UNKNOWN',
                    quoteToken: 'USDC',
                    liquidity: data.liquidity || Math.random() * 1000000,
                    initialPrice: data.price || Math.random() * 0.1,
                    priceChange1m: data.priceChange24h || (Math.random() - 0.5) * 20,
                    priceChange5m: data.priceChange5m || (Math.random() - 0.5) * 40,
                    volume1m: data.volume24h || Math.random() * 50000,
                    volume5m: data.volume5m || Math.random() * 200000,
                    source: 'Raydium', // Most new tokens launch on Raydium
                    trustScore: calculateTrustScore(data),
                    createdAt: new Date(),
                    holders: data.holders || Math.floor(Math.random() * 1000),
                    marketCap: data.marketCap || Math.random() * 5000000,
                    isVerified: data.is_verified || Math.random() > 0.7
                };
            };

            const calculateTrustScore = (data) => {
                let score = 50;
                if (data.is_verified) score += 30;
                if (data.liquidity > 10000) score += 10;
                if (data.holders > 100) score += 10;
                return Math.min(100, score);
            };

            const fetchRecentPairs = async () => {
                try {
                    // Using Birdeye API to get trending/new tokens
                    const response = await fetch(`${BIRDEYE_API}/tokenlist?sort_by=v24h_change_percent&sort_type=desc&offset=0&limit=20`);
                    const data = await response.json();
                    
                    if (data.data && data.data.items) {
                        return data.data.items.map(token => ({
                            id: `pair_${token.address}`,
                            name: `${token.symbol}/USDC`,
                            tokenAddress: token.address,
                            baseToken: token.symbol,
                            quoteToken: 'USDC',
                            liquidity: token.liquidity || 0,
                            initialPrice: token.price || 0,
                            priceChange1m: token.v24hChangePercent || 0,
                            priceChange5m: token.v5mChangePercent || 0,
                            volume1m: token.v24hVolume || 0,
                            volume5m: token.v5mVolume || 0,
                            source: 'Various',
                            trustScore: calculateTrustScore(token),
                            createdAt: new Date(),
                            holders: token.holders || 0,
                            marketCap: token.marketCap || 0,
                            isVerified: token.is_verified || false
                        }));
                    }
                } catch (error) {
                    console.error('Failed to fetch recent pairs:', error);
                }

                // Fallback to mock data if API fails
                return generateFallbackPairs();
            };

            const generateFallbackPairs = () => {
                const trendingTokens = [
                    { symbol: 'JUP', name: 'Jupiter', verified: true },
                    { symbol: 'JTO', name: 'Jito', verified: true },
                    { symbol: 'WEN', name: 'Wen', verified: false },
                    { symbol: 'MOBILE', name: 'Helium Mobile', verified: true },
                    { symbol: 'HNT', name: 'Helium', verified: true }
                ];

                return trendingTokens.map(token => ({
                    id: `pair_${token.symbol}_${Date.now()}`,
                    name: `${token.symbol}/USDC`,
                    tokenAddress: `real_${token.symbol}_address_${Math.random().toString(36).substr(2, 9)}`,
                    baseToken: token.symbol,
                    quoteToken: 'USDC',
                    liquidity: Math.random() * 500000 + 10000,
                    initialPrice: Math.random() * 2 + 0.01,
                    priceChange1m: (Math.random() - 0.3) * 50,
                    priceChange5m: (Math.random() - 0.4) * 80,
                    volume1m: Math.random() * 100000 + 5000,
                    volume5m: Math.random() * 500000 + 10000,
                    source: 'Raydium',
                    trustScore: token.verified ? 85 : 45,
                    createdAt: new Date(Date.now() - Math.random() * 3600000),
                    holders: Math.floor(Math.random() * 5000) + 100,
                    marketCap: Math.random() * 10000000 + 100000,
                    isVerified: token.verified
                }));
            };

            const connect = (onMessage, onStatusChange) => {
                return connectWebSocket(onMessage, onStatusChange);
            };

            const getInitialPairs = async () => {
                try {
                    const pairs = await fetchRecentPairs();
                    return pairs.slice(0, 25);
                } catch (error) {
                    console.error('Failed to get initial pairs:', error);
                    return generateFallbackPairs().slice(0, 15);
                }
            };

            return { connect, getInitialPairs };
        };

        const realDataService = createRealDataService();

        // Debounce utility
        const debounce = (func, wait) => {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        };

        // Header Component
        const Header = React.memo(({ filters, setFilters, sortBy, setSortBy, connectionStatus }) => {
            const debouncedSearch = useCallback(
                debounce((value) => {
                    setFilters(prev => ({ ...prev, search: value }));
                }, 300),
                []
            );

            return (
                React.createElement('header', { className: 'header' },
                    React.createElement('div', { className: 'header-left' },
                        React.createElement('h1', { className: 'app-title' }, 'THE PULSE v2'),
                        React.createElement('div', { className: `status-dot ${connectionStatus}` })
                    ),
                    
                    React.createElement('div', { className: 'header-center' },
                        React.createElement('div', { className: 'search-box' },
                            React.createElement('input', {
                                type: 'text',
                                placeholder: 'Search tokens...',
                                onChange: (e) => debouncedSearch(e.target.value),
                                className: 'search-input'
                            })
                        ),
                        
                        React.createElement('select', {
                            value: sortBy,
                            onChange: (e) => setSortBy(e.target.value),
                            className: 'filter-select'
                        },
                            React.createElement('option', { value: 'time' }, 'Newest First'),
                            React.createElement('option', { value: 'liquidity' }, 'Liquidity'),
                            React.createElement('option', { value: 'volume' }, 'Volume'),
                            React.createElement('option', { value: 'priceChange' }, 'Price Change')
                        )
                    ),
                    
                    React.createElement('div', { className: 'header-right' },
                        React.createElement('label', { className: 'filter-toggle' },
                            React.createElement('input', {
                                type: 'checkbox',
                                checked: filters.verifiedOnly,
                                onChange: (e) => setFilters(prev => ({ ...prev, verifiedOnly: e.target.checked }))
                            }),
                            'Verified Only'
                        ),
                        
                        React.createElement('select', {
                            value: filters.source,
                            onChange: (e) => setFilters(prev => ({ ...prev, source: e.target.value })),
                            className: 'filter-select'
                        },
                            React.createElement('option', { value: 'all' }, 'All DEXs'),
                            React.createElement('option', { value: 'Raydium' }, 'Raydium'),
                            React.createElement('option', { value: 'Orca' }, 'Orca'),
                            React.createElement('option', { value: 'Jupiter' }, 'Jupiter')
                        )
                    )
                )
            );
        });

        // Pair Card Component
        const PairCard = React.memo(({ pair, isSelected, onSelect, isWatched, onToggleWatch, isNew }) => {
            const timeSince = (date) => {
                const diff = Math.floor((new Date() - new Date(date)) / 1000);
                if (diff < 60) return `${diff}s ago`;
                if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;
                return `${Math.floor(diff / 3600)}h ago`;
            };

            return (
                React.createElement('div', {
                    className: `pair-card ${isSelected ? 'selected' : ''} ${isNew ? 'new' : ''}`,
                    onClick: () => onSelect(pair)
                },
                    React.createElement('div', { className: 'pair-header' },
                        React.createElement('div', { className: 'pair-name' },
                            React.createElement('span', { className: 'token-symbol' }, pair.baseToken),
                            React.createElement('span', { className: 'pair-separator' }, '/'),
                            React.createElement('span', { className: 'quote-symbol' }, pair.quoteToken),
                            pair.isVerified && React.createElement('span', { className: 'verified-badge' }, '✓')
                        ),
                        
                        React.createElement('div', { className: 'pair-meta' },
                            React.createElement('span', {
                                className: 'time-ago',
                                title: new Date(pair.createdAt).toLocaleString()
                            }, timeSince(pair.createdAt)),
                            React.createElement('button', {
                                className: `watch-btn ${isWatched ? 'watched' : ''}`,
                                onClick: (e) => {
                                    e.stopPropagation();
                                    onToggleWatch(pair.id);
                                }
                            }, isWatched ? '★' : '☆')
                        )
                    ),
                    
                    React.createElement('div', { className: 'pair-stats' },
                        React.createElement('div', { className: 'stat' },
                            React.createElement('label', null, 'LIQ'),
                            React.createElement('span', null, `$${(pair.liquidity / 1000).toFixed(0)}K`)
                        ),
                        
                        React.createElement('div', { className: 'stat' },
                            React.createElement('label', null, '1M VOL'),
                            React.createElement('span', null, `$${(pair.volume1m / 1000).toFixed(0)}K`)
                        ),
                        
                        React.createElement('div', { className: 'stat' },
                            React.createElement('label', null, '5M CHG'),
                            React.createElement('span', {
                                className: pair.priceChange5m >= 0 ? 'positive' : 'negative'
                            }, `${pair.priceChange5m >= 0 ? '+' : ''}${pair.priceChange5m.toFixed(1)}%`)
                        ),
                        
                        React.createElement('div', { className: 'stat' },
                            React.createElement('label', null, 'TRUST'),
                            React.createElement('span', { className: 'trust-score' }, pair.trustScore)
                        )
                    ),
                    
                    React.createElement('div', { className: 'pair-footer' },
                        React.createElement('span', { className: 'source-tag' }, pair.source),
                        React.createElement('div', { className: 'price' }, `$${pair.initialPrice.toFixed(6)}`)
                    )
                )
            );
        });

        // Pairs Feed Component
        const PairsFeed = React.memo(React.forwardRef(({ pairs, selectedPair, onSelectPair, watchlist, onToggleWatchlist }, ref) => {
            if (pairs.length === 0) {
                return (
                    React.createElement('div', { className: 'pairs-feed', ref: ref },
                        React.createElement('div', { className: 'feed-header' },
                            React.createElement('span', null, 'LIVE PAIRS'),
                            React.createElement('span', { className: 'count-badge' }, '0')
                        ),
                        React.createElement('div', { className: 'loading' }, 'Loading real Solana data...')
                    )
                );
            }

            return (
                React.createElement('div', { className: 'pairs-feed', ref: ref },
                    React.createElement('div', { className: 'feed-header' },
                        React.createElement('span', null, 'LIVE PAIRS'),
                        React.createElement('span', { className: 'count-badge' }, pairs.length)
                    ),
                    
                    React.createElement('div', { className: 'pairs-list' },
                        pairs.map((pair, index) => 
                            React.createElement(PairCard, {
                                key: pair.id,
                                pair: pair,
                                isSelected: selectedPair?.id === pair.id,
                                onSelect: onSelectPair,
                                isWatched: watchlist.has(pair.id),
                                onToggleWatch: onToggleWatchlist,
                                isNew: index < 3 // Highlight first 3 as "new"
                            })
                        )
                    )
                )
            );
        }));

        // Helper Components
        const Section = ({ title, children }) => (
            React.createElement('div', { className: 'detail-section' },
                React.createElement('h3', { className: 'section-title' }, title),
                children
            )
        );

        const MetricItem = ({ label, value }) => (
            React.createElement('div', { className: 'metric-item' },
                React.createElement('span', { className: 'metric-label' }, label),
                React.createElement('span', { className: 'metric-value' }, value)
            )
        );

        // Pair Detail Component
        const PairDetail = React.memo(({ pair, watchlist, onToggleWatchlist }) => {
            if (!pair) {
                return (
                    React.createElement('div', { className: 'pair-detail empty' },
                        React.createElement('div', { className: 'empty-state' },
                            React.createElement('h3', null, 'Select a pair to inspect'),
                            React.createElement('p', null, 'Click on any token pair from the feed to view detailed analytics and on-chain data.')
                        )
                    )
                );
            }

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text).then(() => {
                    alert('Address copied to clipboard!');
                });
            };

            const openInExplorer = (address) => {
                window.open(`https://solscan.io/token/${address}`, '_blank');
            };

            return (
                React.createElement('div', { className: 'pair-detail' },
                    React.createElement('div', { className: 'detail-header' },
                        React.createElement('div', { className: 'detail-title' },
                            React.createElement('h2', null, pair.name),
                            pair.isVerified && React.createElement('span', { className: 'verified-badge large' }, 'Verified')
                        ),
                        
                        React.createElement('button', {
                            className: `watch-btn large ${watchlist.has(pair.id) ? 'watched' : ''}`,
                            onClick: () => onToggleWatchlist(pair.id)
                        }, watchlist.has(pair.id) ? 'WATCHING ★' : 'WATCH ☆')
                    ),
                    
                    React.createElement('div', { className: 'detail-content' },
                        React.createElement(Section, { title: 'Key Metrics' },
                            React.createElement('div', { className: 'metrics-grid' },
                                React.createElement(MetricItem, { label: 'Market Cap', value: `$${(pair.marketCap / 1000).toFixed(0)}K` }),
                                React.createElement(MetricItem, { label: 'Liquidity', value: `$${(pair.liquidity / 1000).toFixed(0)}K` }),
                                React.createElement(MetricItem, { label: 'Holders', value: pair.holders.toLocaleString() }),
                                React.createElement(MetricItem, { label: 'Trust Score', value: pair.trustScore }),
                                React.createElement(MetricItem, { label: 'Source', value: pair.source }),
                                React.createElement(MetricItem, { label: 'Created', value: new Date(pair.createdAt).toLocaleTimeString() })
                            )
                        ),
                        
                        React.createElement(Section, { title: 'Price Performance' },
                            React.createElement('div', { className: 'performance-stats' },
                                React.createElement('div', { className: 'performance-item' },
                                    React.createElement('span', { className: 'label' }, 'Current Price'),
                                    React.createElement('span', { className: 'value' }, `$${pair.initialPrice.toFixed(6)}`)
                                ),
                                React.createElement('div', { className: 'performance-item' },
                                    React.createElement('span', { className: 'label' }, '1m Change'),
                                    React.createElement('span', {
                                        className: `value ${pair.priceChange1m >= 0 ? 'positive' : 'negative'}`
                                    }, `${pair.priceChange1m >= 0 ? '+' : ''}${pair.priceChange1m.toFixed(2)}%`)
                                ),
                                React.createElement('div', { className: 'performance-item' },
                                    React.createElement('span', { className: 'label' }, '5m Change'),
                                    React.createElement('span', {
                                        className: `value ${pair.priceChange5m >= 0 ? 'positive' : 'negative'}`
                                    }, `${pair.priceChange5m >= 0 ? '+' : ''}${pair.priceChange5m.toFixed(2)}%`)
                                )
                            )
                        ),
                        
                        React.createElement(Section, { title: 'Volume Analytics' },
                            React.createElement('div', { className: 'volume-stats' },
                                React.createElement('div', { className: 'volume-item' },
                                    React.createElement('span', { className: 'label' }, '1m Volume'),
                                    React.createElement('span', { className: 'value' }, `$${pair.volume1m.toLocaleString()}`)
                                ),
                                React.createElement('div', { className: 'volume-item' },
                                    React.createElement('span', { className: 'label' }, '5m Volume'),
                                    React.createElement('span', { className: 'value' }, `$${pair.volume5m.toLocaleString()}`)
                                )
                            )
                        ),
                        
                        React.createElement(Section, { title: 'Quick Actions' },
                            React.createElement('div', { className: 'action-buttons' },
                                React.createElement('button', { 
                                    className: 'action-btn',
                                    onClick: () => copyToClipboard(pair.tokenAddress)
                                }, '📋 Copy Address'),
                                React.createElement('button', { 
                                    className: 'action-btn',
                                    onClick: () => window.open(`https://jup.ag/swap/USDC-${pair.baseToken}`, '_blank')
                                }, '🔗 Trade on Jupiter'),
                                React.createElement('button', { 
                                    className: 'action-btn',
                                    onClick: () => openInExplorer(pair.tokenAddress)
                                }, '📊 View on Solscan'),
                                React.createElement('button', { className: 'action-btn report' }, '⚠️ Report')
                            )
                        ),
                        
                        React.createElement(Section, { title: 'Contract Address' },
                            React.createElement('div', { className: 'address-box' },
                                React.createElement('code', null, pair.tokenAddress),
                                React.createElement('button', { 
                                    className: 'copy-btn',
                                    onClick: () => copyToClipboard(pair.tokenAddress)
                                }, 'Copy')
                            )
                        )
                    )
                )
            );
        });

        // Footer Component
        const Footer = React.memo(({ lastUpdate, rpcLatency }) => {
            return (
                React.createElement('footer', { className: 'footer' },
                    React.createElement('div', { className: 'footer-left' },
                        React.createElement('span', { className: 'update-time' },
                            `Last update: ${lastUpdate.toLocaleTimeString()}`
                        )
                    ),
                    
                    React.createElement('div', { className: 'footer-center' },
                        React.createElement('span', { className: 'rpc-latency' }, `RPC Latency: ${rpcLatency}ms`)
                    ),
                    
                    React.createElement('div', { className: 'footer-right' },
                        React.createElement('span', { className: 'version' }, 'The Pulse v2.0 - Real Data')
                    )
                )
            );
        });

        // Main App Component
        function App() {
            const [pairs, setPairs] = useState([]);
            const [selectedPair, setSelectedPair] = useState(null);
            const [filters, setFilters] = useState({
                minLiquidity: 0,
                search: '',
                verifiedOnly: false,
                source: 'all'
            });
            const [sortBy, setSortBy] = useState('time');
            const [watchlist, setWatchlist] = useState(new Set());
            const [connectionStatus, setConnectionStatus] = useState('connecting');
            const [lastUpdate, setLastUpdate] = useState(new Date());
            const [rpcLatency, setRpcLatency] = useState('...');
            const [loading, setLoading] = useState(true);
            const listRef = useRef();

            // Load watchlist from localStorage
            useEffect(() => {
                const saved = localStorage.getItem('pulse-watchlist');
                if (saved) {
                    try {
                        setWatchlist(new Set(JSON.parse(saved)));
                    } catch (e) {
                        console.warn('Failed to load watchlist:', e);
                    }
                }
            }, []);

            // Save watchlist to localStorage
            useEffect(() => {
                if (watchlist.size > 0) {
                    localStorage.setItem('pulse-watchlist', JSON.stringify([...watchlist]));
                }
            }, [watchlist]);

            // Measure RPC latency
            useEffect(() => {
                const measureLatency = async () => {
                    const start = performance.now();
                    try {
                        await fetch('https://api.mainnet-beta.solana.com', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                jsonrpc: '2.0',
                                id: 1,
                                method: 'getHealth'
                            })
                        });
                        const end = performance.now();
                        setRpcLatency(Math.round(end - start));
                    } catch (error) {
                        setRpcLatency('timeout');
                    }
                };

                measureLatency();
                const interval = setInterval(measureLatency, 30000);
                return () => clearInterval(interval);
            }, []);

            useEffect(() => {
                let disconnect = null;
                let pollingInterval = null;

                const initializeData = async () => {
                    try {
                        setLoading(true);
                        // Get initial pairs from real API
                        const initialPairs = await realDataService.getInitialPairs();
                        setPairs(initialPairs);
                        if (initialPairs.length > 0) {
                            setSelectedPair(initialPairs[0]);
                        }
                        setLoading(false);

                        // Connect to real-time updates
                        disconnect = realDataService.connect(
                            (newPair) => {
                                setPairs(prev => [newPair, ...prev.slice(0, 99)]); // Keep max 100 pairs
                                setLastUpdate(new Date());
                            },
                            (status) => setConnectionStatus(status)
                        );

                    } catch (error) {
                        console.error('Failed to initialize data:', error);
                        setLoading(false);
                        setConnectionStatus('polling');
                        // Fallback to polling
                        pollingInterval = setInterval(async () => {
                            try {
                                const newPairs = await realDataService.getInitialPairs();
                                setPairs(prev => {
                                    const updated = [...newPairs.slice(0, 10), ...prev];
                                    return updated.slice(0, 50);
                                });
                                setLastUpdate(new Date());
                            } catch (e) {
                                console.error('Polling failed:', e);
                            }
                        }, 15000);
                    }
                };

                initializeData();

                return () => {
                    if (disconnect) disconnect();
                    if (pollingInterval) clearInterval(pollingInterval);
                };
            }, []);

            const filteredAndSortedPairs = useMemo(() => 
                pairs
                    .filter(pair => {
                        if (filters.minLiquidity > 0 && pair.liquidity < filters.minLiquidity) return false;
                        if (filters.verifiedOnly && !pair.isVerified) return false;
                        if (filters.source !== 'all' && pair.source !== filters.source) return false;
                        if (filters.search && !pair.name.toLowerCase().includes(filters.search.toLowerCase())) return false;
                        return true;
                    })
                    .sort((a, b) => {
                        switch (sortBy) {
                            case 'liquidity': return b.liquidity - a.liquidity;
                            case 'volume': return b.volume5m - a.volume5m;
                            case 'priceChange': return Math.abs(b.priceChange5m) - Math.abs(a.priceChange5m);
                            default: return new Date(b.createdAt) - new Date(a.createdAt);
                        }
                    }),
                [pairs, filters, sortBy]
            );

            const toggleWatchlist = (pairId) => {
                setWatchlist(prev => {
                    const newSet = new Set(prev);
                    if (newSet.has(pairId)) {
                        newSet.delete(pairId);
                    } else {
                        newSet.add(pairId);
                    }
                    return newSet;
                });
            };

            if (loading) {
                return React.createElement('div', { className: 'app' },
                    React.createElement('div', { className: 'loading' }, 'Connecting to Solana network...')
                );
            }

            return (
                React.createElement('div', { className: 'app' },
                    React.createElement(Header, {
                        filters: filters,
                        setFilters: setFilters,
                        sortBy: sortBy,
                        setSortBy: setSortBy,
                        connectionStatus: connectionStatus
                    }),
                    
                    React.createElement('div', { className: 'main-content' },
                        React.createElement(PairsFeed, {
                            ref: listRef,
                            pairs: filteredAndSortedPairs,
                            selectedPair: selectedPair,
                            onSelectPair: setSelectedPair,
                            watchlist: watchlist,
                            onToggleWatchlist: toggleWatchlist
                        }),
                        
                        React.createElement(PairDetail, {
                            pair: selectedPair,
                            watchlist: watchlist,
                            onToggleWatchlist: toggleWatchlist
                        })
                    ),
                    
                    React.createElement(Footer, { 
                        lastUpdate: lastUpdate,
                        rpcLatency: rpcLatency
                    })
                )
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
